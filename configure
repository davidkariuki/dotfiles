#!/usr/bin/env zsh

set -e

echo "Configuring npm & bun"
mkdir -p ~/.npm-global
npm config set prefix ~/.npm-global
npm i -g bun

echo "Configuring sddm..."
sudo cp -R .config/sddm/catppuccin-mocha /usr/share/sddm/themes/
sudo cp .config/sddm/sddm.conf /etc/

echo "Enabling & disabling services..."
sudo systemctl enable bluetooth.service --now
sudo systemctl enable nordvpnd.service --now
sudo usermod -aG nordvpn $USER

echo "Starting Desktop Configuration..."

if ! [[ $SHELL == *"zsh"* ]]; then
	chsh -s $(which zsh)
fi

echo "Setting up ZSH plugins..."
sleep 2
if [ ! -d ~/.oh-my-zsh ]; then
	sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi
if [ ! -d ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions ]; then
	git clone https://github.com/zsh-users/zsh-autosuggestions.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
fi

if [ ! -d ~/.oh-my-zsh/custom/plugins/F-Sy-H ]; then
	git clone https://github.com/z-shell/F-Sy-H.git \
		${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/plugins/F-Sy-H
fi

if [ ! -d ~/.oh-my-zsh/custom/plugins/zsh-vi-mode ]; then
  git clone https://github.com/jeffreytse/zsh-vi-mode \
  ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/plugins/zsh-vi-mode
fi

echo "Installing tmux plugins..."
sleep 2
if [ ! -d ~/.tmux/plugins/tpm ]; then
	mkdir -p ~/.tmux/plugins
	git clone https://github.com/tmux-plugins/tpm.git ~/.tmux/plugins/tpm
fi

echo "Installation complete."
